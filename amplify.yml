version: 1
frontend:
  phases:
    preBuild:
      commands:
        - git submodule sync --recursive
        - git submodule update --init --recursive
        - export HUGO_VER=0.143.1
        - curl -sSL -o hugo.tar.gz https://github.com/gohugoio/hugo/releases/download/v${HUGO_VER}/hugo_extended_${HUGO_VER}_Linux-64bit.tar.gz
        - tar -xzf hugo.tar.gz
        - chmod +x ./hugo
        - export PATH=$PWD:$PATH
        - ./hugo version
        - export HUGO_ENV=production
    build:
      commands:
        - ./hugo --gc --minify --cleanDestinationDir
  artifacts:
    baseDirectory: public
    files:
      - '**/*'
  cache:
    paths: []
